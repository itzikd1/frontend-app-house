<div class="tasks-page">
  <div class="tasks-header">
    <h1>Tasks</h1>
    <p class="tasks-subtitle">Manage your tasks and stay organized</p>
    <button class="add-task-btn" (click)="openAddTaskDialog()">+ Add Task</button>
  </div>

  <div class="tasks-tabs">
    <button class="tab active">Tasks</button>
    <button class="tab">Manage Categories</button>
  </div>

  <div class="tasks-dashboard">
    <app-dashboard-summary-cards
      [cards]="dashboardCards"
    ></app-dashboard-summary-cards>
  </div>

  <div class="tasks-filters">
    <div class="status-filters">
      <button class="status-btn" [class.active]="selectedStatus === 'all'" (click)="setStatus('all')">All ({{ tasks().length }})</button>
    </div>
    <div class="tag-filters">
      <button class="tag-btn" [class.active]="selectedCategory === 'all'" (click)="setCategory('all')">All</button>
      <button class="tag-btn" [class.active]="selectedCategory === 'home'" (click)="setCategory('home')">Home</button>
      <button class="tag-btn" [class.active]="selectedCategory === 'work'" (click)="setCategory('work')">Work</button>
    </div>
  </div>

  <div *ngIf="loading()">
    <app-loading-spinner [translationKey]="'loading.default'"></app-loading-spinner>
  </div>
  <div *ngIf="!loading()">
    <div *ngIf="error(); else showTasks">
      <p class="error">{{ error() }}</p>
    </div>
    <ng-template #showTasks>
      <div *ngIf="filteredTasks.length; else noTasks" class="tasks-list">
        <app-item-card
          *ngFor="let task of filteredTasks"
          [item]="task"
          (edit)="startEdit(task)"
          (delete)="deleteTask(task.id)"
        >
          <div class="task-meta-row">
            <span class="task-title">{{ task.title }}</span>
            <span class="task-priority-badge" [ngClass]="task.priority.toLowerCase()">{{ task.priority }}</span>
            <span *ngIf="task.dueDate" class="task-due-date">
              <mat-icon class="due-date-icon">error</mat-icon>
              <span [ngClass]="{'overdue': isOverdue(task)}">{{ task.dueDate | date:'MMM d, yyyy' }}</span>
            </span>
          </div>
        </app-item-card>
      </div>
      <ng-template #noTasks>
        <p>No tasks found.</p>
      </ng-template>
    </ng-template>
  </div>
</div>
